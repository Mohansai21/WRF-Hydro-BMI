---
phase: 06-babelizer-environment-skeleton
task: 0
total_tasks: 2
status: planned_not_executed
last_updated: 2026-02-25T05:05:16.562Z
---

<current_state>
Phase 6 (Babelizer Environment + Skeleton) is fully planned but NOT yet executed. All three planning stages completed successfully:
1. Context gathered (06-CONTEXT.md) — user decisions captured
2. Research completed (06-RESEARCH.md) — babelizer 0.3.9 investigated, naming chain verified
3. Plan created and verified (06-01-PLAN.md) — checker passed all 7 dimensions

The next step is to execute the plan: `/gsd:execute-phase 6`
</current_state>

<completed_work>

- /gsd:discuss-phase 6 — DONE: User selected all 4 gray areas (package location, babel.toml details, environment strategy, skeleton verification). All decisions captured in 06-CONTEXT.md.
- /gsd:plan-phase 6 — DONE: Researcher found babelizer 0.3.9 generates setuptools-based packages (setup.py, not meson.build). Planner created 06-01-PLAN.md (1 plan, 2 tasks, 1 wave). Checker verified all 7 dimensions passed.
- Phase 5 (Library Hardening) — DONE: C binding layer removed, libbmiwrfhydrof.so rebuilt without conflicting symbols, 151 tests pass.
</completed_work>

<remaining_work>

- /gsd:execute-phase 6 — NOT STARTED: This runs 06-01-PLAN.md which has 2 tasks:
  - Task 1: Snapshot conda env, install 6 packages (babelizer, meson-python, meson, ninja, cython, python-build)
  - Task 2: Pre-flight check, write babel.toml, run babelize init, verify skeleton files, inspect bmi_interoperability.f90, dry-run build, document results for Phase 7
- Phases 7-9 still ahead after Phase 6 execution
</remaining_work>

<decisions_made>

- Package location: pymt_wrfhydro/ at project root (alongside bmi_wrf_hydro/)
- babel.toml: project root, naming chain locked (library=bmiwrfhydrof, entry_point=bmi_wrf_hydro, package.name=pymt_wrfhydro)
- Runtime deps: mpi4py + netCDF4
- Environment: install into existing wrfhydro-bmi env, snapshot first, all 6 packages in one command
- Conflicts: resolve rather than create new env
- Verification: file checklist + inspect bmi_interoperability.f90 content + dry-run build with failure docs
- Commit: only after verification passes
- Babelizer version: 0.3.9 from conda-forge (generates setup.py, not meson.build)
</decisions_made>

<blockers>
None — all prerequisites in place (libbmiwrfhydrof.so installed, pkg-config working, .mod files in place)
</blockers>

<context>
Phase 6 is a toolchain setup + code generation phase. The babelizer reads babel.toml and generates a complete Python package skeleton (pymt_wrfhydro/) with auto-generated Fortran C interop code (bmi_interoperability.f90) and Cython wrappers. The critical thing is getting the naming chain right — library name must match the Fortran module name, entry_point must match the derived type name. Research confirmed all names align with our actual source code.

Key risk from research: babelizer 0.3.9 uses setuptools + numpy.distutils (deprecated), which may cause issues with newer setuptools (80.10.2 in our env). This is flagged as a Phase 7 build concern, not a Phase 6 blocker.

The v2.0 Babelizer milestone has 5 phases (5-9). Phase 5 is done. Phase 6 is planned. Phases 7-9 are unplanned.
</context>

<next_action>
Start with: `/gsd:execute-phase 6` — this will run the plan that installs babelizer, writes babel.toml, generates the pymt_wrfhydro skeleton, and verifies everything. Remember to `/clear` first for a fresh context window.
</next_action>
